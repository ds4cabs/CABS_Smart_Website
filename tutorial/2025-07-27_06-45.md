# Tutorial: Using Python for Gene Expression Analysis with Machine Learning

## Question

How can we leverage machine learning to analyze gene expression data for classification of cancer subtypes?

## Solution

In this tutorial, we will use Python along with libraries like `pandas`, `numpy`, `scikit-learn`, and `matplotlib` to preprocess gene expression data and classify cancer samples using a Random Forest classifier.

### Step 1: Import Libraries

```python
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import classification_report, confusion_matrix
import matplotlib.pyplot as plt
import seaborn as sns
```

### Step 2: Load the Gene Expression Data

Assuming we have a CSV file `gene_expression.csv` where rows are genes and columns are samples, with one column being the cancer subtype label.

```python
# Load the dataset
data = pd.read_csv('gene_expression.csv')

# Display the first few rows of the dataset
print(data.head())
```

### Step 3: Preprocess the Data

- Separate features and labels
- Handle missing values

```python
# Separate features and labels
X = data.drop('cancer_subtype', axis=1)
y = data['cancer_subtype']

# Handle missing values (if any)
X.fillna(X.mean(), inplace=True)
```

### Step 4: Split Data into Training and Testing Sets

```python
# Split the dataset into training and testing sets
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
```

### Step 5: Train the Random Forest Classifier

```python
# Create a Random Forest Classifier
clf = RandomForestClassifier(n_estimators=100, random_state=42)

# Train the model
clf.fit(X_train, y_train)
```

### Step 6: Make Predictions

```python
# Make predictions on the test set
y_pred = clf.predict(X_test)
```

### Step 7: Evaluate the Model

```python
# Print classification report
print(classification_report(y_test, y_pred))

# Create a confusion matrix
conf_matrix = confusion_matrix(y_test, y_pred)

# Visualize the confusion matrix
plt.figure(figsize=(10, 7))
sns.heatmap(conf_matrix, annot=True, fmt='d', cmap='Blues', xticklabels=np.unique(y), yticklabels=np.unique(y))
plt.ylabel('Actual')
plt.xlabel('Predicted')
plt.title('Confusion Matrix')
plt.show()
```

### Conclusion

This tutorial demonstrates how to use Python for gene expression analysis and classification using machine learning. You can modify the parameters and try different algorithms for better results depending on your dataset.