# Tutorial: Advanced AI in Bioinformatics - Gene Expression Analysis with Python

## Question
How can we use deep learning to classify gene expression data to predict cancer subtypes?

## Solution

### Overview
In this tutorial, we'll build and train a deep learning model using Keras to classify cancer subtypes based on gene expression data. We'll use a dataset that includes gene expression profiles and their corresponding cancer subtypes.

### Prerequisites
- Python
- TensorFlow
- Pandas
- Numpy
- Scikit-learn

### Setup

```bash
pip install tensorflow pandas numpy scikit-learn
```

### Step 1: Import Libraries

```python
import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, Dropout
from tensorflow.keras.utils import to_categorical
```

### Step 2: Load Dataset

```python
# Load your dataset (replace 'gene_expression.csv' with the actual file path)
data = pd.read_csv('gene_expression.csv')
X = data.iloc[:, :-1].values  # Features (gene expression data)
y = data.iloc[:, -1].values   # Target (cancer subtypes)
```

### Step 3: Preprocess the Data

```python
# Encode labels (cancer subtypes)
from sklearn.preprocessing import LabelEncoder

label_encoder = LabelEncoder()
y_encoded = label_encoder.fit_transform(y)
y_categorical = to_categorical(y_encoded)

# Split the dataset into training and testing sets
X_train, X_test, y_train, y_test = train_test_split(X, y_categorical, test_size=0.2, random_state=42)

# Standardize features
scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)
```

### Step 4: Build the Model

```python
model = Sequential()
model.add(Dense(128, activation='relu', input_shape=(X_train.shape[1],)))
model.add(Dropout(0.5))
model.add(Dense(64, activation='relu'))
model.add(Dropout(0.5))
model.add(Dense(y_categorical.shape[1], activation='softmax'))  # Output layer
```

### Step 5: Compile the Model

```python
model.compile(optimizer='adam',
              loss='categorical_crossentropy',
              metrics=['accuracy'])
```

### Step 6: Train the Model

```python
history = model.fit(X_train, y_train, 
                    validation_data=(X_test, y_test),
                    epochs=50, 
                    batch_size=32)
```

### Step 7: Evaluate the Model

```python
loss, accuracy = model.evaluate(X_test, y_test)
print(f'Test Accuracy: {accuracy:.2f}')
```

### Step 8: Make Predictions

```python
# Predicting the cancer subtype for new samples
new_samples = np.array([[...], [...], ...])  # Replace with actual values
new_samples_scaled = scaler.transform(new_samples)
predictions = model.predict(new_samples_scaled)
predicted_classes = np.argmax(predictions, axis=1)
predicted_labels = label_encoder.inverse_transform(predicted_classes)
print(predicted_labels)
```

### Conclusion
This tutorial demonstrated how to classify gene expression data using a deep learning approach in Python. Adjust the model structure and hyperparameters based on your specific dataset for optimal results.