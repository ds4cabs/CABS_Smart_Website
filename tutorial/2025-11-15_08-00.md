# Question
How can we use Python to analyze genomic sequences and identify motifs in DNA sequences using an advanced machine learning approach?

# Solution

## Step 1: Install Required Libraries
Make sure you have the following libraries installed:

```bash
pip install biopython scikit-learn pandas
```

## Step 2: Import Libraries

```python
import numpy as np
import pandas as pd
from Bio import SeqIO
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split
from sklearn.metrics import classification_report, confusion_matrix
```

## Step 3: Load DNA Sequences

```python
def load_sequences(file_path):
    sequences = []
    labels = []
    for record in SeqIO.parse(file_path, "fasta"):
        sequences.append(str(record.seq))
        labels.append(record.id)
    return sequences, labels

file_path = "data/sequences.fasta"
sequences, labels = load_sequences(file_path)
```

## Step 4: Feature Extraction

We will extract k-mer features from the DNA sequences.

```python
def kmer_features(sequences, k):
    kmer_counts = []
    for seq in sequences:
        counts = {}
        for i in range(len(seq) - k + 1):
            kmer = seq[i:i+k]
            counts[kmer] = counts.get(kmer, 0) + 1
        kmer_counts.append(counts)
        
    return pd.DataFrame(kmer_counts).fillna(0)

k = 4  # Change k value for different k-mer sizes
features = kmer_features(sequences, k)
```

## Step 5: Prepare Labels and Split Data

```python
# Convert labels to binary (example: 0 for non-cancer, 1 for cancer)
binary_labels = [1 if 'cancer' in label else 0 for label in labels]
X_train, X_test, y_train, y_test = train_test_split(features, binary_labels, test_size=0.2, random_state=42)
```

## Step 6: Train a Model

Using a Random Forest Classifier for motif identification.

```python
model = RandomForestClassifier(n_estimators=100, random_state=42)
model.fit(X_train, y_train)
```

## Step 7: Model Evaluation

Evaluate the model using test data.

```python
y_pred = model.predict(X_test)

print(confusion_matrix(y_test, y_pred))
print(classification_report(y_test, y_pred))
```

## Step 8: Making Predictions on New Data

```python
def predict_sequence(sequence, model, k):
    sequence_features = kmer_features([sequence], k)
    prediction = model.predict(sequence_features)
    return prediction

new_sequence = "ACGTACGTACGTACGT"
print("Prediction for new sequence:", predict_sequence(new_sequence, model, k))
```

## Conclusion
This tutorial demonstrated how to use Python to analyze genomic sequences, extract features, and identify motifs using machine learning techniques. Adjust the `k` parameter in k-mers to explore different motif lengths and improve model accuracy.